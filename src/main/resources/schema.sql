
CREATE TABLE IF NOT EXISTS exchange_rate (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    from_currency VARCHAR(8) NOT NULL,
    to_currency  VARCHAR(8) NOT NULL,
    rate         DOUBLE PRECISION NOT NULL,
    updated_at   TIMESTAMP NOT NULL
);
CREATE UNIQUE INDEX IF NOT EXISTS ux_rate_pair
  ON exchange_rate(from_currency, to_currency);

CREATE TABLE IF NOT EXISTS exchange_tx (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id          BIGINT NOT NULL,
    user_name        VARCHAR(200) NOT NULL,
    from_currency    VARCHAR(8) NOT NULL,
    to_currency      VARCHAR(8) NOT NULL,
    amount           DOUBLE PRECISION NOT NULL,
    rate             DOUBLE PRECISION NOT NULL,
    converted_amount DOUBLE PRECISION NOT NULL,
    created_at       TIMESTAMP NOT NULL
);
